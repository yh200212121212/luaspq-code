; Listing generated by Microsoft (R) Optimizing Compiler Version 18.00.21005.1 

	TITLE	F:\0\luaspq-1.1\luaspq-1.1\src\lmem.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	_luaM_toobig
PUBLIC	_luaM_realloc_
PUBLIC	_luaM_growaux_
PUBLIC	??_C@_0BK@JNOIBMBC@too?5many?5?$CFs?5?$CIlimit?5is?5?$CFd?$CJ?$AA@ ; `string'
PUBLIC	??_C@_0CH@LBFPMMCP@memory?5allocation?5error?3?5block?5t@ ; `string'
EXTRN	_luaG_runerror:PROC
EXTRN	_luaD_throw:PROC
EXTRN	_luaC_fullgc:PROC
;	COMDAT ??_C@_0CH@LBFPMMCP@memory?5allocation?5error?3?5block?5t@
CONST	SEGMENT
??_C@_0CH@LBFPMMCP@memory?5allocation?5error?3?5block?5t@ DB 'memory allo'
	DB	'cation error: block too big', 00H		; `string'
CONST	ENDS
;	COMDAT ??_C@_0BK@JNOIBMBC@too?5many?5?$CFs?5?$CIlimit?5is?5?$CFd?$CJ?$AA@
CONST	SEGMENT
??_C@_0BK@JNOIBMBC@too?5many?5?$CFs?5?$CIlimit?5is?5?$CFd?$CJ?$AA@ DB 'to'
	DB	'o many %s (limit is %d)', 00H		; `string'
CONST	ENDS
; Function compile flags: /Ogtp
;	COMDAT _luaM_growaux_
_TEXT	SEGMENT
_L$ = 8							; size = 4
_block$ = 12						; size = 4
_size$ = 16						; size = 4
_size_elems$ = 20					; size = 4
_limit$ = 24						; size = 4
_what$ = 28						; size = 4
_luaM_growaux_ PROC					; COMDAT
; File f:\0\luaspq-1.1\luaspq-1.1\src\lmem.c
; Line 49
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
; Line 52
  00003	8b 45 10	 mov	 eax, DWORD PTR _size$[ebp]
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	8b 75 18	 mov	 esi, DWORD PTR _limit$[ebp]
  0000b	57		 push	 edi
  0000c	8b 38		 mov	 edi, DWORD PTR [eax]
  0000e	8b c6		 mov	 eax, esi
  00010	99		 cdq
  00011	2b c2		 sub	 eax, edx
  00013	d1 f8		 sar	 eax, 1
  00015	3b f8		 cmp	 edi, eax
  00017	7c 06		 jl	 SHORT $LN4@luaM_growa
; Line 53
  00019	3b fe		 cmp	 edi, esi
  0001b	7c 0f		 jl	 SHORT $LN1@luaM_growa
  0001d	eb 40		 jmp	 SHORT $LN13@luaM_growa
$LN4@luaM_growa:
; Line 58
  0001f	8d 34 3f	 lea	 esi, DWORD PTR [edi+edi]
; Line 59
  00022	b8 04 00 00 00	 mov	 eax, 4
  00027	3b f0		 cmp	 esi, eax
  00029	0f 4c f0	 cmovl	 esi, eax
$LN1@luaM_growa:
; Line 62
  0002c	8b 5d 14	 mov	 ebx, DWORD PTR _size_elems$[ebp]
  0002f	8d 4e 01	 lea	 ecx, DWORD PTR [esi+1]
  00032	83 c8 ff	 or	 eax, -1
  00035	33 d2		 xor	 edx, edx
  00037	f7 f3		 div	 ebx
  00039	3b c8		 cmp	 ecx, eax
  0003b	77 33		 ja	 SHORT $LN15@luaM_growa
  0003d	8b c6		 mov	 eax, esi
  0003f	0f af fb	 imul	 edi, ebx
  00042	0f af c3	 imul	 eax, ebx
  00045	50		 push	 eax
  00046	57		 push	 edi
  00047	ff 75 0c	 push	 DWORD PTR _block$[ebp]
  0004a	ff 75 08	 push	 DWORD PTR _L$[ebp]
  0004d	e8 00 00 00 00	 call	 _luaM_realloc_
; Line 63
  00052	8b 4d 10	 mov	 ecx, DWORD PTR _size$[ebp]
  00055	83 c4 10	 add	 esp, 16			; 00000010H
  00058	5f		 pop	 edi
  00059	89 31		 mov	 DWORD PTR [ecx], esi
  0005b	5e		 pop	 esi
  0005c	5b		 pop	 ebx
; Line 65
  0005d	5d		 pop	 ebp
  0005e	c3		 ret	 0
$LN13@luaM_growa:
; Line 54
  0005f	56		 push	 esi
  00060	ff 75 1c	 push	 DWORD PTR _what$[ebp]
  00063	68 00 00 00 00	 push	 OFFSET ??_C@_0BK@JNOIBMBC@too?5many?5?$CFs?5?$CIlimit?5is?5?$CFd?$CJ?$AA@
  00068	ff 75 08	 push	 DWORD PTR _L$[ebp]
  0006b	e8 00 00 00 00	 call	 _luaG_runerror
$LN16@luaM_growa:
$LN15@luaM_growa:
; Line 62
  00070	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@LBFPMMCP@memory?5allocation?5error?3?5block?5t@
  00075	ff 75 08	 push	 DWORD PTR _L$[ebp]
  00078	e8 00 00 00 00	 call	 _luaG_runerror
$LN17@luaM_growa:
$LN12@luaM_growa:
  0007d	cc		 int	 3
_luaM_growaux_ ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
;	COMDAT _luaM_realloc_
_TEXT	SEGMENT
_realosize$1$ = 8					; size = 4
_L$ = 8							; size = 4
_block$ = 12						; size = 4
_osize$ = 16						; size = 4
_nsize$ = 20						; size = 4
_luaM_realloc_ PROC					; COMDAT
; File f:\0\luaspq-1.1\luaspq-1.1\src\lmem.c
; Line 77
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
; Line 80
  00003	8b 4d 0c	 mov	 ecx, DWORD PTR _block$[ebp]
  00006	33 c0		 xor	 eax, eax
  00008	8b 55 10	 mov	 edx, DWORD PTR _osize$[ebp]
  0000b	85 c9		 test	 ecx, ecx
  0000d	53		 push	 ebx
  0000e	8b 5d 08	 mov	 ebx, DWORD PTR _L$[ebp]
  00011	0f 45 c2	 cmovne	 eax, edx
  00014	56		 push	 esi
  00015	57		 push	 edi
; Line 86
  00016	8b 7d 14	 mov	 edi, DWORD PTR _nsize$[ebp]
  00019	8b 73 10	 mov	 esi, DWORD PTR [ebx+16]
  0001c	57		 push	 edi
  0001d	52		 push	 edx
  0001e	51		 push	 ecx
  0001f	ff 76 04	 push	 DWORD PTR [esi+4]
  00022	89 45 08	 mov	 DWORD PTR _realosize$1$[ebp], eax
  00025	8b 06		 mov	 eax, DWORD PTR [esi]
  00027	ff d0		 call	 eax
  00029	83 c4 10	 add	 esp, 16			; 00000010H
; Line 87
  0002c	85 c0		 test	 eax, eax
  0002e	75 29		 jne	 SHORT $LN1@luaM_reall
  00030	85 ff		 test	 edi, edi
  00032	74 25		 je	 SHORT $LN1@luaM_reall
; Line 89
  00034	39 86 80 00 00
	00		 cmp	 DWORD PTR [esi+128], eax
  0003a	74 28		 je	 SHORT $LN8@luaM_reall
; Line 90
  0003c	6a 01		 push	 1
  0003e	53		 push	 ebx
  0003f	e8 00 00 00 00	 call	 _luaC_fullgc
; Line 91
  00044	8b 06		 mov	 eax, DWORD PTR [esi]
  00046	57		 push	 edi
  00047	ff 75 10	 push	 DWORD PTR _osize$[ebp]
  0004a	ff 75 0c	 push	 DWORD PTR _block$[ebp]
  0004d	ff 76 04	 push	 DWORD PTR [esi+4]
  00050	ff d0		 call	 eax
  00052	83 c4 18	 add	 esp, 24			; 00000018H
; Line 93
  00055	85 c0		 test	 eax, eax
  00057	74 0b		 je	 SHORT $LN8@luaM_reall
$LN1@luaM_reall:
; Line 97
  00059	2b 7d 08	 sub	 edi, DWORD PTR _realosize$1$[ebp]
  0005c	01 7e 0c	 add	 DWORD PTR [esi+12], edi
  0005f	5f		 pop	 edi
  00060	5e		 pop	 esi
  00061	5b		 pop	 ebx
; Line 99
  00062	5d		 pop	 ebp
  00063	c3		 ret	 0
$LN8@luaM_reall:
; Line 94
  00064	6a 04		 push	 4
  00066	53		 push	 ebx
  00067	e8 00 00 00 00	 call	 _luaD_throw
$LN10@luaM_reall:
$LN7@luaM_reall:
  0006c	cc		 int	 3
_luaM_realloc_ ENDP
_TEXT	ENDS
; Function compile flags: /Ogtp
;	COMDAT _luaM_toobig
_TEXT	SEGMENT
_L$ = 8							; size = 4
_luaM_toobig PROC					; COMDAT
; File f:\0\luaspq-1.1\luaspq-1.1\src\lmem.c
; Line 68
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
; Line 69
  00003	68 00 00 00 00	 push	 OFFSET ??_C@_0CH@LBFPMMCP@memory?5allocation?5error?3?5block?5t@
  00008	ff 75 08	 push	 DWORD PTR _L$[ebp]
  0000b	e8 00 00 00 00	 call	 _luaG_runerror
$LN4@luaM_toobi:
$LN3@luaM_toobi:
  00010	cc		 int	 3
_luaM_toobig ENDP
_TEXT	ENDS
END
